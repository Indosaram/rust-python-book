---
marp: true
paginate: true
theme: default
---

# íŒŒì´ì¬ í”„ë¡œê·¸ëž˜ë¨¸ë¥¼ ìœ„í•œ ëŸ¬ìŠ¤íŠ¸ ìž…ë¬¸

ìœ¤ì¸ë„
freedomzero91@gmail.com

---

## í´ë¡œì €ì™€ ì†Œìœ ê¶Œ

ì•žì—ì„œ í´ë¡œì €ë¥¼ ë‹¨ìˆœížˆ ìµëª… í•¨ìˆ˜ë¼ê³ ë§Œ ì„¤ëª…í•˜ê³  ë„˜ì–´ê°”ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ì œ ìŠ¤ì½”í”„ì™€ ì†Œìœ ê¶Œì„ ë°°ì› ê¸° ë•Œë¬¸ì—, í´ë¡œì €ì— ëŒ€í•´ ì¢€ë” ìžì„¸í•œ ì–˜ê¸°ë¥¼ í•´ë³´ë ¤ê³  í•©ë‹ˆë‹¤.

*í´ë¡œì €ì˜ ê°€ìž¥ í° íŠ¹ì§•ì€ ìµëª… í•¨ìˆ˜ë¥¼ ë§Œë“¤ê³  ì´ë¥¼ ë³€ìˆ˜ì— ì €ìž¥í•˜ê±°ë‚˜ ë‹¤ë¥¸ í•¨ìˆ˜ì˜ ì¸ìžë¡œ ì „ë‹¬í•  ìˆ˜ ìžˆë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤.*

---

### í´ë¡œì €ì˜ í™˜ê²½ ìº¡ì²˜

í´ë¡œì €ëŠ” í´ë¡œì €ê°€ ì„ ì–¸ëœ ìŠ¤ì½”í”„ì— ìžˆëŠ” ì§€ì—­ ë³€ìˆ˜ë¥¼ ìžì‹ ì˜ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìžˆëŠ”ë°, ì´ë¥¼ í™˜ê²½ ìº¡ì²˜(Environment capture)ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. í´ë¡œì €ê°€ ë³€ìˆ˜ë¥¼ ìžì‹ ì˜ ìŠ¤ì½”í”„ ë‚´ë¶€ë¡œ ê°€ì ¸ê°€ëŠ” ë°©ë²•ì€ ì´ 3ê°€ì§€ê°€ ì¡´ìž¬í•©ë‹ˆë‹¤.

- ë¶ˆë³€ ì†Œìœ ê¶Œ ëŒ€ì—¬
- ê°€ë³€ ì†Œìœ ê¶Œ ëŒ€ì—¬
- ì†Œìœ ê¶Œ ê°€ì ¸ê°€ê¸°

---

#### ë¶ˆë³€ ì†Œìœ ê¶Œ ëŒ€ì—¬
í´ë¡œì € `func` ëŠ” ê°™ì€ ìŠ¤ì½”í”„ì— ì„ ì–¸ëœ ë³€ìˆ˜ `multiplier`ë¥¼ ìžì‹ ì˜ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì´ë•Œ `multiplier`ì˜ ê°’ì€ í´ë¡œì €ì—ì„œ ì‚¬ìš©ëœ ì´í›„ì—ë„ ìŠ¤ì½”í”„ ë‚´ë¶€ì—ì„œ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```rust
fn main() {
    let multiplier = 5;

    let func = |x: i32| -> i32 { x * multiplier };

    for i in 1..=5 {
        println!("{}", func(i));
    }

    println!("{}", multiplier); // ðŸ‘
}

```

---

#### ê°€ë³€ ì†Œìœ ê¶Œ ëŒ€ì—¬

ì•„ëž˜ ì˜ˆì œëŠ” `multiplier`ë¥¼ ê°€ë³€ ë³€ìˆ˜ë¡œ ì„ ì–¸í•˜ê³ , í´ë¡œì € ë‚´ë¶€ì—ì„œ `multiplier`ì˜ ê°’ì„ ë³€ê²½ì‹œí‚¤ê³  ìžˆìŠµë‹ˆë‹¤. ë°©ê¸ˆ ì‚´íŽ´ë³¸ ì˜ˆì œì™€ ë§ˆì°¬ê°€ì§€ë¡œ í´ë¡œì € í˜¸ì¶œì´ ëë‚œ ë‹¤ìŒì—ë„ ì—¬ì „ížˆ `multiplier`ì— ì ‘ê·¼ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```rust
fn main() {
    let mut multiplier = 5;

    let mut func = |x: i32| -> i32 {
        multiplier += 1;
        x * multiplier
    };

    for i in 1..=5 {
        println!("{}", func(i));
    }

    println!("{}", multiplier); // ðŸ‘
}

```


---

### `move` ë¥¼ ì‚¬ìš©í•œ ì†Œìœ ê¶Œ ì´ë™

í´ë¡œì €ê°€ í™˜ê²½ìœ¼ë¡œë¶€í„° ì‚¬ìš©í•˜ëŠ” ê°’ì˜ ì†Œìœ ê¶Œì„ ê°€ì ¸ê°ˆ ìˆ˜ë„ ìžˆìŠµë‹ˆë‹¤. í´ë¡œì €ê°€ ê°™ì€ ìŠ¤ì½”í”„ì— ì„ ì–¸ëœ ì§€ì—­ ë³€ìˆ˜ì˜ ì†Œìœ ê¶Œì„ ê°€ì ¸ê°€ë„ë¡ í•˜ë ¤ë©´ í´ë¡œì €ì˜ íŒŒë¼ë¯¸í„°ë¥¼ ì„ ì–¸í•˜ëŠ” ì½”ë“œ ì•žì— `move` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤. 

```rust
move | param, ... | body;
```


---

ë‹¤ìŒ ì˜ˆì œì—ì„œëŠ” í´ë¡œì €ë¥¼ ë¦¬í„´í•˜ëŠ” í•¨ìˆ˜ `factory`ë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.
- ì—¬ê¸°ì„œ ë¦¬í„´ë˜ëŠ” í´ë¡œì €ëŠ” `factory` í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ì¸ `factor`ë¥¼ ìº¡ì²˜í•´ ì‚¬ìš©í•©ë‹ˆë‹¤.
- `multiplier` ë³€ìˆ˜ë¥¼ ëª¨ë“  í´ë¡œì €ì—ì„œ ê³µìœ í•  ìˆ˜ ìžˆê²Œ ë©ë‹ˆë‹¤.

```rust
fn factory(factor: i32) -> impl Fn(i32) -> i32 {
    |x| x * factor
}

fn main() {
    let multiplier = 5;
    let mult = factory(multiplier);
    for i in 1..=3 {
        println!("{}", mult(i));
    }
}

```

---
í•˜ì§€ë§Œ ìœ„ ì½”ë“œë¥¼ ì»´íŒŒì¼í•˜ë©´, ì•„ëž˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.

```text
error[E0597]: `factor` does not live long enough
 --> src/main.rs:2:13
  |
2 |     |x| x * factor
  |     ---     ^^^^^^ borrowed value does not live long enough
  |     |
  |     value captured here
3 | }
  |  -
  |  |
  |  `factor` dropped here while still borrowed
  |  borrow later used here

For more information about this error, try `rustc --explain E0597`.
error: could not compile `notebook` due to previous error
```


---
ë¬¸ì œì :
- `factor` ë³€ìˆ˜ê°€ í´ë¡œì € ì•ˆì— ìº¡ì²˜ë  ë•Œ, ì†Œìœ ê¶Œì´ `factory`ë¡œë¶€í„° í´ë¡œì €ë¡œ ëŒ€ì—¬ë©ë‹ˆë‹¤.
- `factory`í•¨ìˆ˜ê°€ ì¢…ë£Œë˜ë©´ `factor` ë³€ìˆ˜ì˜ ê°’ì´ ì‚­ì œë©ë‹ˆë‹¤.


---

í•´ê²° ë°©ë²•:
`move`ëŠ” ìº¡ì²˜ëœ ë³€ìˆ˜ì˜ ì†Œìœ ê¶Œì„ í´ë¡œì € ì•ˆìœ¼ë¡œ ì´ë™ì‹œí‚µë‹ˆë‹¤.

```rust
fn factory(factor: i32) -> impl Fn(i32) -> i32 {
    move |x| x * factor
}

fn main() {
    let multiplier = 5;
    let mult = factory(multiplier);
    for i in 1..=3 {
        println!("{}", mult(i));
    }
}
```


---

> í´ë¡œì €ì—ì„œ `move` ë¥¼ ê°€ìž¥ ë§Žì´ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ëŠ” ë©€í‹°ìŠ¤ë ˆë“œ í˜¹ì€ ë¹„ë™ê¸° í”„ë¡œê·¸ëž˜ë°ì„ ìž‘ì„±í•  ë•Œìž…ë‹ˆë‹¤.



---

## Quiz

#### 1. 
ë‹¤ìŒ íŽ˜ì´ì§€ì˜ ì½”ë“œì—ì„œ `inc1`ê³¼ `inc2`ëŠ” ê°™ì€ `count` ë³€ìˆ˜ë¥¼ ìº¡ì²˜í•´ì„œ ì‚¬ìš©í•©ë‹ˆë‹¤. ì•„ëž˜ ì½”ë“œë¥¼ ìˆ˜ì •í•´ì„œ, `inc1`ê³¼ `inc2`ê°€ ê°ê° ë‹¤ë¥¸ `count` ë³€ìˆ˜ë¥¼ ìº¡ì²˜í•˜ë„ë¡ ë§Œë“¤ì–´ë³´ì„¸ìš”. ì½”ë“œë¥¼ ì‹¤í–‰í–ˆì„ ë•Œ, ë‹¤ìŒ ê²°ê³¼ê°€ ë‚˜ì˜¤ë©´ ë©ë‹ˆë‹¤.

```
count: 1
count: 1
```

---

```rust
fn main() {
    let mut count = 0;

    let mut inc1 = || {
        count += 1;
        println!("count: {}", count);
    };

    inc1();

    let mut inc2 = || {
        count += 1;
        println!("count: {}", count);
    };

    inc2();
}

```
---

ì •ë‹µ
```rust
fn main() {
    let mut count = 0;

    let mut inc1 = move || {
        count += 1;
        println!("count: {}", count);
    };

    inc1();

    let mut inc2 = move || {
        count += 1;
        println!("count: {}", count);
    };

    inc2();
}

```


---

#### 2.

ì•„ëž˜ ì½”ë“œê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ë„ë¡ `factory` í•¨ìˆ˜ë¥¼ ìˆ˜ì •í•˜ì„¸ìš”.

ížŒíŠ¸: í´ë¡œì €ì˜ íƒ€ìž…ì€ `impl Fn(_) -> _`ê³¼ ê°™ì´ ìž‘ì„±í•˜ë©´ ë©ë‹ˆë‹¤.

```rust
fn factory() -> _ {
    let num = 5;

    |x| x + num
}

fn main() {
    println!("{}", factory()(1));
}
```


---

ì •ë‹µ
```rust
fn factory() -> impl Fn(i32) -> i32 {
    let num = 5;

    move |x| x + num
}

fn main() {
    println!("{}", factory()(1));
}
```
